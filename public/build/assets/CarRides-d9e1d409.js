import{u as M}from"./CarRide-c91fac1d.js";import{d as S,a as B,b as E,r,o as c,j as y,e as a,F as j,q as z,f as o,w as i,g as h,t as w,i as R,h as n,c as k,m as F,s as G,p as I,v as $,x as P,y as H,k as N,z as U}from"./app-f25a100e.js";import{m as q}from"./constants-68fdd4d6.js";import{_ as L}from"./Add.vue_vue_type_script_setup_true_lang-4a6c6994.js";const O={class:"w-100 d-flex flex-column"},T={class:"pa-2 tw-h-16 d-flex flex-column justify-space-between tw-relative"},Q=a("div",{class:"tw-absolute tw-h-3/5 tw-border-l-2 tw-border-pink-500 tw-border-dotted tw-top-[10.5px] tw-left-[13px]"},null,-1),J={key:0,class:"tw-leading-none d-flex align-center"},K={class:"tw-font-bold"},W={class:"tw-text-xs ml-2 tw-text-gray-400"},X={class:"px-2 pb-2 pt-4 d-flex flex-column justify-space-between tw-flex-grow"},Z={class:"flex-grow-1"},ee={class:"d-flex justify-space-between"},te={class:"tw-leading-none"},ne={class:"tw-text-xl tw-leading-[3px]"},se={class:"text-grey-darken-1 tw-text-base"},ae={key:0,class:"tw-text-gray-500"},oe=["href"],le={class:"d-flex flex-column align-end"},ie={class:"text-right tw-leading-none"},re={class:"d-flex justify-space-between align-end"},ce={class:"tw-leading-none tw-relative tw-top-1"},de={class:"tw-text-gray-500 tw-translate-y-1"},ue={class:"tw-uppercase tw-text-2xl tw-font-semibold tw-text-gray-600 tw-inline-flex tw-items-center"},_e=S({__name:"CarRideRenderer",props:["params"],setup(V){M();const e=V.params.data;B();const t=E(),p=g=>[0,e.cities.length-1].includes(g)==!0;return(g,C)=>{const m=r("v-icon"),x=r("v-tooltip"),d=r("v-btn"),s=r("v-chip");return c(),y("section",O,[a("main",T,[Q,(c(!0),y(j,null,z(n(e).cities,(l,u)=>(c(),y(j,null,[p(u)?(c(),y("aside",J,[o(m,{class:"mr-2 tw-text-xs bg-white",color:"pink"},{default:i(()=>[h(" mdi-circle-outline ")]),_:1}),a("span",K,w(l.district.name),1),a("span",W,w(l.district.region.name.replace("viloyati","V.")),1)])):R("",!0)],64))),256))]),a("main",X,[a("section",Z,[a("div",ee,[a("main",te,[a("div",ne,[h(w(n(e).car.type)+" ",1),a("span",se,w(n(e).car.number),1)]),n(t).user.role==3?(c(),y("div",ae,[a("a",{href:`tel:${n(e).phone}`},w(n(e).phone),9,oe)])):R("",!0)]),a("main",le,[a("div",ie,[(c(!0),y(j,null,z(n(e).free_seat,l=>(c(),k(m,{color:"pink"},{default:i(()=>[h(" mdi-account-settings ")]),_:1}))),256))])])])]),a("section",re,[a("div",ce,[a("p",de,w(n(F)(n(e).ride_time).format("HH:mm")),1),a("span",ue,[h(w(n(F)(n(e).ride_time).format("D-MMMM"))+" ",1),n(e).strictly_on_time?(c(),k(d,{key:0,icon:"",size:"x-small",variant:"text"},{default:i(()=>[o(m,null,{default:i(()=>[h("mdi-book-clock")]),_:1}),o(x,{activator:"parent","open-on-click":!0,location:"bottom"},{default:i(()=>[h("Qat'iy shu vaqtda")]),_:1})]),_:1})):R("",!0)])]),o(s,{size:"large",variant:"tonal",color:"primary",class:"tw-font-semibold tw-translate-x-10 pr-10"},{default:i(()=>[h(w(n(G)(n(e).price,n(q)))+" so'm ",1)]),_:1})])])])}}}),me=S({__name:"Filter",setup(V,{expose:v}){const e=M(),t=I({start_city:null,end_city:null,ride_time:null}),p=$(()=>e.rides==null?[]:e.rides.map(s=>{var l;return(l=s.cities[0])==null?void 0:l.district}).filter((s,l,u)=>l===u.findIndex(f=>f.id===s.id))),g=$(()=>{if(e.rides==null)return[];const d=[];return e.rides.forEach(s=>{s.cities.forEach((l,u)=>{u!=0&&d.push(l.district)})}),d.filter((s,l,u)=>l===u.findIndex(f=>f.id===s.id))});function C(d){var D;const s=t.ride_time==null?null:F(t.ride_time).format("YYYY-MM-DD"),l=[null,(D=d.data.cities[0])==null?void 0:D.district_id].includes(t.start_city),f=[null,...d.data.cities.filter((b,Y)=>Y!=0).map(b=>b==null?void 0:b.district_id)].includes(t.end_city),A=[F(d.data.ride_time).format("YYYY-MM-DD"),null].includes(s);return l&&f&&A}const m=$(()=>Object.values(t).every(s=>[null,""].includes(s)));function x(){t.start_city=null,t.end_city=null,t.ride_time=null}return v({filters:C,resetFilter:x,filtered:m}),P(()=>t,()=>e.agGrid.onFilterChanged(),{deep:!0}),(d,s)=>{const l=r("v-btn"),u=r("v-autocomplete"),f=r("v-col"),A=r("VDatePicker"),D=r("v-row"),b=r("v-card"),Y=r("v-menu");return c(),k(Y,{"close-on-content-click":!1,location:"bottom"},{activator:i(({props:_})=>[a("main",null,[o(l,H({color:"primary",variant:"text"},_,{"prepend-icon":"mdi-filter"}),{default:i(()=>[h(" Filterlar ")]),_:2},1040),m.value==!1?(c(),k(l,{key:0,color:"primary",size:"x-small",variant:"text",onClick:x,icon:"mdi-close"})):R("",!0)])]),default:i(()=>[o(b,{elevation:"2",rounded:"sm",width:280},{default:i(()=>[o(D,{class:"ma-0"},{default:i(()=>[o(f,{cols:"12"},{default:i(()=>[o(u,{label:"Shahar | A",modelValue:t.start_city,"onUpdate:modelValue":s[0]||(s[0]=_=>t.start_city=_),clearable:"",items:p.value,"item-title":"name","item-value":_=>_.id,variant:"plain"},null,8,["modelValue","items","item-value"])]),_:1}),o(f,{cols:"12"},{default:i(()=>[o(u,{label:"Shahar | B",modelValue:t.end_city,"onUpdate:modelValue":s[1]||(s[1]=_=>t.end_city=_),clearable:"",items:g.value,"item-title":"name","item-value":_=>_.id,variant:"plain"},null,8,["modelValue","items","item-value"])]),_:1}),o(f,{cols:"12",class:"d-flex align-center flex-column py-0"},{default:i(()=>[o(A,{"min-date":new Date,modelValue:t.ride_time,"onUpdate:modelValue":s[2]||(s[2]=_=>t.ride_time=_),mode:"date",transparent:"",borderless:"",expanded:""},null,8,["min-date","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})}}}),pe=S({__name:"Sorting",setup(V){const v=M();let e=0;const t=["asc","desc",null],p=()=>{v.agColumnApi.applyColumnState({state:[{colId:"ride_time",sort:t[e],sortIndex:1}]}),e<2?e++:e=0};return(g,C)=>{const m=r("v-btn");return c(),k(m,{onClick:p,variant:"plain",icon:"mdi-sort"})}}}),fe=[{cellRenderer:_e,flex:1,valueFormatter:null,cellClass:["px-0","align-stretch"]},{field:"ride_time",hide:!0},{field:"price",hide:!0},{field:"free_seat",hide:!0}],xe={class:"d-flex flex-column"},we={class:"d-flex align-center justify-space-between w-100"},be=S({__name:"CarRides",setup(V){const v=N(),e=M();e.index();function t(p){e.agGrid=p.api,e.agColumnApi=p.columnApi}return U(()=>{e.agGrid=null,e.agColumnApi=null}),(p,g)=>{const C=r("AgGridVue"),m=r("v-spacer");return c(),y("main",xe,[a("main",we,[o(n(L),{date:!0}),o(n(me),{ref_key:"filterComponent",ref:v},null,512),o(n(pe))]),o(m,null,{default:i(()=>[o(C,{class:"ag-theme-ruzzifer ag-theme-alpine h-100",animateRows:!0,defaultColDef:{sortable:!0},rowHeight:170,rowClass:n(e).rowClass,headerHeight:0,columnDefs:n(fe),rowData:n(e).rides,onGridReady:t,getRowId:({data:x})=>x.id,doesExternalFilterPass:x=>v.value.filters(x),isExternalFilterPresent:()=>!0},null,8,["rowClass","columnDefs","rowData","getRowId","doesExternalFilterPass"])]),_:1})])}}});export{be as default};
