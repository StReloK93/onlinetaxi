import{C as O,k as C,d as A,q as E,p as T,r as i,A as S,o as f,c as x,w as o,e as a,b as p,f as h,g as _,B as z,n as V,h as U,x as B,j as F,t as j,a as H}from"./app-3d24e990.js";import{u as P}from"./useMainStore-9927c65c.js";import{r as D}from"./constants-68fdd4d6.js";const R=O("useTransport",()=>{const g=C(null),w=C(null),m=C([]);function u(n){g.value.getRowNode(n.id).setData(n)}function s(){axios.get("user-cars/get-only-my").then(({data:n})=>m.value=n)}function e(n){axios.delete(`user-car/${n.id}`).then(()=>{m.value=m.value.filter(r=>r.id!=n.id),g.value!=null&&g.value.applyTransaction({remove:[n]})})}return{agGrid:g,agColumnApi:w,transports:m,update:u,getTransports:s,destroy:e}}),Z={class:"text-caption"},Y=p("span",{class:"text-blue-grey-lighten-1"}," Agarda sizning transportingiz ro'yhatda yo'q bo'lsa adminga murojat qiling! ",-1),J={class:"d-flex justify-space-between mb-2"},K=p("img",{src:"/iconos/uz.png",class:"tw-w-3 tw-absolute tw-right-0.5 tw-top-0.5"},null,-1),L=p("img",{src:"/iconos/uz.png",class:"tw-w-3 tw-absolute tw-right-0.5 tw-top-0.5"},null,-1),N=A({__name:"Inputs",emits:["onReady","onStart"],setup(g,{expose:w,emit:m}){const u=m;u("onStart");const s=E(()=>{const l={mask:"## A ### AA",tokens:{A:{pattern:/[A-Z]/,transform:d=>d.toUpperCase()}}},t={mask:"## ### AAA",tokens:{A:{pattern:/[A-Z]/,transform:d=>d.toUpperCase()}}};return e.number_variant?l:t}),e=T({car_company_id:null,car_id:null,number:null,fuel_type:null,trunk:!1,number_variant:!0}),n=T({car_company:[],fuel_types:[],cars:[],car_input_loading:!1});async function r(l){n.car_input_loading=!0,e.car_id=null,await axios.get(`car/${l}`).then(({data:t})=>{n.cars=t}),n.car_input_loading=!1}return axios.all([axios.get("fuel_type"),axios.get("car-company")]).then(axios.spread(({data:l},{data:t})=>{n.fuel_types=l,n.car_company=t,u("onReady")})),w({formData:e,carMarkChanged:r}),(l,t)=>{const d=i("v-icon"),b=i("v-col"),k=i("v-select"),v=i("v-label"),$=i("v-sheet"),y=i("v-text-field"),G=i("v-switch"),I=i("v-row"),q=S("ripple"),M=S("maska");return f(),x(I,null,{default:o(()=>[a(b,{cols:"12"},{default:o(()=>[p("p",Z,[a(d,{class:"mr-2",color:"primary"},{default:o(()=>[h(" mdi-bell ")]),_:1}),Y])]),_:1}),a(b,{sm:"6",cols:"12"},{default:o(()=>[a(k,{"onUpdate:modelValue":[t[0]||(t[0]=c=>r(c)),t[1]||(t[1]=c=>e.car_company_id=c)],items:n.car_company,modelValue:e.car_company_id,label:"Transport markasi","item-title":"name","item-value":c=>c.id,rules:_(D)},null,8,["items","modelValue","item-value","rules"])]),_:1}),a(b,{sm:"6",cols:"12"},{default:o(()=>[a(k,{disabled:e.car_company_id==null,items:n.cars,modelValue:e.car_id,"onUpdate:modelValue":t[2]||(t[2]=c=>e.car_id=c),label:"Transport turi","item-title":"name","item-value":c=>c.id,rules:_(D),loading:n.car_input_loading},null,8,["disabled","items","modelValue","item-value","rules","loading"])]),_:1}),a(b,{sm:"6",cols:"12",class:"py-0"},{default:o(()=>[a(v,{class:"tw-text-xs"},{default:o(()=>[h(" Transport raqami turini tanlang ")]),_:1}),p("div",J,[z((f(),x($,{onClick:t[3]||(t[3]=c=>e.number_variant=!0),class:V([{"tw-bg-pink-50 !tw-border-pink-600":e.number_variant},"tw-border rounded tw-border-gray-600 d-flex tw-relative"]),height:26},{default:o(()=>[p("div",{class:V([{"!tw-border-pink-600":e.number_variant},"d-flex justify-center align-center tw-w-7 tw-border tw-border-gray-600"])},[e.number_variant?(f(),x(d,{key:0,color:"primary",size:"small"},{default:o(()=>[h(" mdi-check ")]),_:1})):U("",!0)],2),p("div",{class:V([{"!tw-border-pink-600":e.number_variant},"d-flex justify-space-between align-center pl-1 pr-4 tw-border tw-border-gray-600 flex-grow-1"])},[h(" A 000 AA "),K],2)]),_:1},8,["class"])),[[q]]),z((f(),x($,{onClick:t[4]||(t[4]=c=>e.number_variant=!1),class:V([{"tw-bg-pink-50 !tw-border-pink-600":!e.number_variant},"tw-border rounded tw-border-gray-600 d-flex tw-relative"]),height:26},{default:o(()=>[p("div",{class:V([{"!tw-border-pink-600":!e.number_variant},"d-flex justify-center align-center tw-w-7 tw-border tw-border-gray-600"])},[e.number_variant?U("",!0):(f(),x(d,{key:0,color:"primary",size:"small"},{default:o(()=>[h(" mdi-check ")]),_:1}))],2),p("div",{class:V([{"!tw-border-pink-600":!e.number_variant},"d-flex justify-space-between align-center pl-1 pr-4 tw-border tw-border-gray-600 flex-grow-1"])},[h(" 000 AAA "),L],2)]),_:1},8,["class"])),[[q]])])]),_:1}),a(b,{sm:"6",cols:"12"},{default:o(()=>[z(a(y,{modelValue:e.number,"onUpdate:modelValue":t[5]||(t[5]=c=>e.number=c),label:"Transport raqamini kiriting",rules:_(D)},null,8,["modelValue","rules"]),[[M,void 0,s.value]])]),_:1}),a(b,{sm:"6",cols:"12"},{default:o(()=>[a(k,{items:n.fuel_types,modelValue:e.fuel_type,"onUpdate:modelValue":t[6]||(t[6]=c=>e.fuel_type=c),label:"Yoqilg'i turi","item-title":"name","item-value":c=>c.id,rules:_(D)},null,8,["items","modelValue","item-value","rules"])]),_:1}),a(b,{sm:"6",cols:"12"},{default:o(()=>[a(G,{modelValue:e.trunk,"onUpdate:modelValue":t[7]||(t[7]=c=>e.trunk=c),label:"Bagaj",class:"px-2"},null,8,["modelValue"])]),_:1})]),_:1})}}}),Q=A({__name:"Add",emits:["create"],setup(g,{emit:w}){const m=w,u=C(),s=T({dialog:!1,overlay:!1});async function e(){const n=u.value.formData;await axios.post("user-car",n).then(({data:r})=>{m("create",r),s.dialog=!1})}return(n,r)=>{const l=i("v-btn"),t=i("v-progress-circular"),d=i("v-overlay"),b=i("CustomForm"),k=i("v-dialog");return f(),x(k,{modelValue:s.dialog,"onUpdate:modelValue":r[4]||(r[4]=v=>s.dialog=v),scrollable:"",width:"600px"},{activator:o(({props:v})=>[a(l,B({color:"primary"},v,{icon:"mdi-plus",class:"add-button"}),null,16)]),default:o(()=>[a(b,{submit:e,title:"Transport kiritish",onClose:r[3]||(r[3]=v=>s.dialog=!1)},{default:o(()=>[a(d,{modelValue:s.overlay,"onUpdate:modelValue":r[0]||(r[0]=v=>s.overlay=v),contained:"",persistent:"",class:"align-center justify-center"},{default:o(()=>[a(t,{color:"primary",indeterminate:"",size:68})]),_:1},8,["modelValue"]),a(N,{onOnStart:r[1]||(r[1]=v=>s.overlay=!0),onOnReady:r[2]||(r[2]=v=>s.overlay=!1),ref_key:"inputComponent",ref:u},null,512)]),_:1})]),_:1},8,["modelValue"])}}}),W=A({__name:"Edit",props:["smButton","id"],emits:["update"],setup(g,{emit:w}){const m=R(),u=C(),s=g,e=T({dialog:!1,overlay:!1});async function n(){const l=u.value.formData;await axios.put(`user-car/${s.id}`,l).then(({data:t})=>m.update(t))}function r(l){e.overlay=!0,axios.get(`user-car/${l}`).then(({data:t})=>{const d=u.value.formData;d.number=t.number,d.fuel_type=t.fuel_type,d.number_variant=t.number_variant,d.car_company_id=t.car.car_company_id,d.trunk=!!t.trunk,u.value.carMarkChanged(d.car_company_id).then(()=>{d.car_id=t.car_id,e.overlay=!1})})}return(l,t)=>{const d=i("v-btn"),b=i("v-progress-circular"),k=i("v-overlay"),v=i("CustomForm"),$=i("v-dialog");return f(),x($,{modelValue:e.dialog,"onUpdate:modelValue":t[3]||(t[3]=y=>e.dialog=y),scrollable:"",width:"600px"},{activator:o(({props:y})=>[s.smButton?(f(),x(d,B({key:0},y,{"prepend-icon":"mdi-pencil",size:"x-small",variant:"tonal",color:"white"}),{default:o(()=>[h(" O'zgaritirish ")]),_:2},1040)):(f(),x(d,B({key:1,size:"small"},y,{variant:"plain",icon:"mdi-pencil"}),null,16))]),default:o(()=>[a(v,{submit:n,title:"Transportni tahrirlash",onVnodeMounted:t[1]||(t[1]=y=>r(s.id)),onClose:t[2]||(t[2]=y=>e.dialog=!1)},{default:o(()=>[a(k,{modelValue:e.overlay,"onUpdate:modelValue":t[0]||(t[0]=y=>e.overlay=y),contained:"",persistent:"",class:"align-center justify-center"},{default:o(()=>[a(b,{color:"primary",indeterminate:"",size:68})]),_:1},8,["modelValue"]),a(N,{ref_key:"inputComponent",ref:u},null,512)]),_:1},512)]),_:1},8,["modelValue"])}}}),X={class:"px-2 w-100 d-flex flex-column"},ee={class:"d-flex justify-space-between flex-grow-1 pt-1"},te={class:"tw-uppercase tw-text-3xl text-primary tw-leading-none"},ae={class:"tw-text-sm tw-text-gray-600 tw-leading-none"},ne={class:"d-flex justify-space-between align-center"},oe={class:"tw-text-base tw-font-semibold tw-text-gray-600"},re=A({__name:"TransportRenderer",props:["params"],setup(g){const w=R(),u=g.params.data,s=P();function e(){s.dialog.open(()=>{s.dialog.title="Transportni o'chirmoqchimisiz ?",s.dialog.subTitle="Ushbu transportga tegishli barcha qatnovlar ham o'chib ketadi.",s.dialog.submit=()=>w.destroy(u)})}return(n,r)=>{const l=i("v-btn");return f(),F("section",X,[p("aside",ee,[p("main",null,[p("h3",te,j(_(u).car.name),1),p("div",ae,j(_(u).car.company.name),1)])]),p("div",ne,[p("h3",oe,j(_(u).number),1),p("span",null,[a(W,{id:_(u).id},null,8,["id"]),a(l,{size:"small",onClick:e,variant:"plain",icon:"mdi-delete"})])])])}}}),se=[{cellRenderer:re,flex:1,valueFormatter:null,cellClass:["px-0","align-stretch"]}],le={class:"d-flex tw-flex-col"},ce=A({__name:"Transports",setup(g){const w=H(),m=R();m.getTransports();const u=C(["!tw-h-28","tw-shadow","tw-border-l-2","tw-border-pink-500","bg-white","tw-rounded-r","overflow-hidden"]);return(s,e)=>{const n=i("AgGridVue"),r=i("v-spacer");return f(),F("main",le,[_(w).isAnyAdmins||_(w).isDriver?(f(),x(_(Q),{key:0,onCreate:e[0]||(e[0]=l=>_(m).agGrid.applyTransaction({add:[l],addIndex:0}))})):U("",!0),a(r,null,{default:o(()=>[a(n,{class:"ag-theme-ruzzifer ag-theme-alpine h-100",rowHeight:125,rowClass:u.value,headerHeight:0,columnDefs:_(se),rowData:_(m).transports,onGridReady:e[1]||(e[1]=l=>_(m).agGrid=l.api),getRowId:({data:l})=>l.id},null,8,["rowClass","columnDefs","rowData","getRowId"])]),_:1})])}}});export{ce as default};
