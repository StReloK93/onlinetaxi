import{u as Y}from"./CarRide-06485fab.js";import{d as $,p as P,q as A,s as E,r as c,o as m,c as R,w as a,e as l,f as n,g as v,v as q,i as D,m as H,u as I,a as N,b as T,j as k,F as G,x as j,h as e,y as U,t as g,z as L,k as O,A as Q}from"./app-1c89fd55.js";import{_ as W,a as J}from"./Edit.vue_vue_type_script_setup_true_lang-81690f9e.js";import{m as K}from"./constants-68fdd4d6.js";function X(){return[{cellRenderer:be,flex:1,valueFormatter:null,cellClass:["px-0","align-stretch"]},{field:"ride_time",hide:!0},{field:"price",hide:!0},{field:"free_seat",hide:!0}]}const Z=$({__name:"Filter",setup(V,{expose:r}){const d=Y(),s=P({start_city:null,end_city:null,ride_time:null}),t=A(()=>d.rides==null?[]:d.rides.map(o=>{var i;return(i=o.cities[0])==null?void 0:i.district}).filter((o,i,w)=>i===w.findIndex(p=>p.id===o.id))),h=A(()=>{if(d.rides==null)return[];const u=[];return d.rides.forEach(o=>{o.cities.forEach((i,w)=>{w!=0&&u.push(i.district)})}),u.filter((o,i,w)=>i===w.findIndex(p=>p.id===o.id))});function y(u){var x;const o=s.ride_time==null?null:H(s.ride_time).format("YYYY-MM-DD"),i=[null,(x=u.data.cities[0])==null?void 0:x.district_id].includes(s.start_city),p=[null,...u.data.cities.filter((b,F)=>F!=0).map(b=>b==null?void 0:b.district_id)].includes(s.end_city),C=[H(u.data.ride_time).format("YYYY-MM-DD"),null].includes(o);return i&&p&&C}const _=A(()=>Object.values(s).every(o=>[null,""].includes(o)));function z(){s.start_city=null,s.end_city=null,s.ride_time=null}return r({filters:y,resetFilter:z,filtered:_}),E(()=>s,()=>d.agGrid.onFilterChanged(),{deep:!0}),(u,o)=>{const i=c("v-btn"),w=c("v-autocomplete"),p=c("v-col"),C=c("VDatePicker"),x=c("v-row"),b=c("v-card"),F=c("v-menu");return m(),R(F,{"close-on-content-click":!1,location:"bottom"},{activator:a(({props:f})=>[l("main",null,[n(i,q({color:"primary",variant:"text"},f,{"prepend-icon":"mdi-filter"}),{default:a(()=>[v(" Filterlar ")]),_:2},1040),_.value==!1?(m(),R(i,{key:0,color:"primary",size:"x-small",variant:"text",onClick:z,icon:"mdi-close"})):D("",!0)])]),default:a(()=>[n(b,{elevation:"2",rounded:"sm",width:280},{default:a(()=>[n(x,{class:"ma-0"},{default:a(()=>[n(p,{cols:"12"},{default:a(()=>[n(w,{label:"Shahar | A",modelValue:s.start_city,"onUpdate:modelValue":o[0]||(o[0]=f=>s.start_city=f),clearable:"",items:t.value,"item-title":"name","item-value":f=>f.id,variant:"plain"},null,8,["modelValue","items","item-value"])]),_:1}),n(p,{cols:"12"},{default:a(()=>[n(w,{label:"Shahar | B",modelValue:s.end_city,"onUpdate:modelValue":o[1]||(o[1]=f=>s.end_city=f),clearable:"",items:h.value,"item-title":"name","item-value":f=>f.id,variant:"plain"},null,8,["modelValue","items","item-value"])]),_:1}),n(p,{cols:"12",class:"d-flex align-center flex-column py-0"},{default:a(()=>[n(C,{"min-date":new Date,modelValue:s.ride_time,"onUpdate:modelValue":o[2]||(o[2]=f=>s.ride_time=f),mode:"date",transparent:"",borderless:"",expanded:""},null,8,["min-date","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})}}}),ee=$({__name:"Sorting",setup(V){const r=Y();let d=0;const s=["asc","desc",null],t=()=>{r.agColumnApi.applyColumnState({state:[{colId:"ride_time",sort:s[d],sortIndex:1}]}),d<2?d++:d=0};return(h,y)=>{const _=c("v-btn");return m(),R(_,{onClick:t,variant:"plain",icon:"mdi-sort"})}}}),B={xl:196,lg:196,md:196,sm:196,xs:292},te={class:"d-flex w-100 tw-flex-col sm:tw-flex-row tw-shadow"},ne={class:"sm:tw-w-1/3 md:tw-w-2/5 lg:tw-w-1/3 bg-pink px-4 tw-h-20 sm:tw-h-[initial] d-flex align-center"},ae={class:"tw-leading-none"},oe={key:0,class:"text-caption tw-text-red-50 tw-text-center sm:tw-text-left"},ie={key:1,class:"tw-font-semibold"},se={class:"sm:tw-w-2/3 md:tw-w-3/5 lg:tw-w-2/3 px-2 py-2 d-flex flex-column justify-space-between tw-flex-grow sm:tw-flex-grow-0"},le={class:"flex-grow-1"},re={class:"d-flex justify-space-between"},ce={class:"tw-leading-none"},de={class:"tw-text-xl tw-leading-[3px]"},ue={class:"text-grey-darken-1 tw-text-base"},me={key:0,class:"py-1 tw-text-gray-500"},_e=["href"],pe={class:"py-1 text-primary"},fe={class:"d-flex flex-column align-end"},ve={class:"text-right tw-leading-none mb-2"},he={class:"d-flex justify-space-between align-end"},we={class:"tw-leading-4"},ge={class:"tw-text-gray-500"},xe={class:"tw-uppercase tw-text-2xl tw-font-semibold tw-text-gray-600 tw-inline-flex tw-items-center"},ye={key:0},be=$({__name:"CarRideRenderer",props:["params"],setup(V){const r=Y(),{mobile:d}=I(),{params:s}=V,t=s.data,h=N(),y=T(),_=A(()=>d.value?"horizontal":"vertical"),z=i=>[0,t.cities.length-1].includes(i)?"pink-darken-2":"transparent",u=i=>[0,t.cities.length-1].includes(i)==!0;function o(){h.dialog.open(()=>{h.dialog.title="Qatnovni o'chirmoqchimisiz ?",h.dialog.subTitle="O'chirilgan qatnovlar savatchada 1 oy muddat saqlanadi.",h.dialog.submit=()=>r.destroy(t)})}return(i,w)=>{const p=c("v-icon"),C=c("v-tooltip"),x=c("v-btn"),b=c("v-timeline-item"),F=c("v-timeline"),f=c("v-chip");return m(),k("section",te,[l("main",ne,[n(F,{direction:_.value,style:{"grid-row-gap":"0px"},"truncate-line":"both",side:"end",density:"compact","line-color":"pink-darken-3"},{default:a(()=>[(m(!0),k(G,null,j(e(t).cities,(S,M)=>(m(),R(b,{"dot-color":z(M),size:"x-small","fill-dot":"",icon:"mdi-record-circle"},U({default:a(()=>[l("div",ae,[u(M)?(m(),k("div",oe,g(S.district.region.name),1)):D("",!0),u(M)?(m(),k("div",ie,[v(g(S.district.name)+" ",1),e(t).address_to_address&&e(t).cities.length-1==M?(m(),R(x,{key:0,icon:"",size:"x-small",variant:"text",density:"comfortable"},{default:a(()=>[n(p,{color:"white"},{default:a(()=>[v("mdi-map-marker")]),_:1}),n(C,{"open-on-click":!0,activator:"parent",location:"bottom"},{default:a(()=>[v("Manzilgacha")]),_:1})]),_:1})):D("",!0)])):D("",!0)])]),_:2},[u(M)==!1?{name:"icon",fn:a(()=>[n(x,{icon:"",size:"x-small",variant:"text"},{default:a(()=>[n(p,{color:"white"},{default:a(()=>[v("mdi-record-circle")]),_:1}),n(C,{"open-on-click":!0,activator:"parent",location:"bottom"},{default:a(()=>[v(g(S.district.name),1)]),_:2},1024)]),_:2},1024)]),key:"0"}:void 0]),1032,["dot-color"]))),256))]),_:1},8,["direction"])]),l("main",se,[l("section",le,[l("div",re,[l("main",ce,[l("div",de,[v(g(e(t).car.type)+" ",1),l("span",ue,g(e(t).car.number),1)]),e(y).user.role==3?(m(),k("div",me,[l("a",{href:`tel:${e(t).phone}`},g(e(t).phone),9,_e)])):D("",!0),l("div",pe,g(e(t).car.fuel.name),1)]),l("main",fe,[l("div",ve,[(m(!0),k(G,null,j(e(t).free_seat,S=>(m(),R(p,{color:"pink"},{default:a(()=>[v(" mdi-account-settings ")]),_:1}))),256))]),n(f,{size:"large",variant:"tonal",color:"primary",class:"tw-font-semibold tw-translate-x-10 pr-10"},{default:a(()=>[v(g(e(L)(e(t).price,e(K)))+" so'm ",1)]),_:1})])])]),l("section",he,[l("div",we,[l("p",ge,g(e(H)(e(t).ride_time).format("HH:mm")),1),l("span",xe,[v(g(e(H)(e(t).ride_time).format("D-MMMM"))+" ",1),e(t).strictly_on_time?(m(),R(x,{key:0,icon:"",size:"x-small",variant:"text"},{default:a(()=>[n(p,null,{default:a(()=>[v("mdi-book-clock")]),_:1}),n(C,{activator:"parent",location:"bottom"},{default:a(()=>[v("Qat'iy shu vaqtda")]),_:1})]),_:1})):D("",!0)])]),e(y).user.role==3||e(y).user.id==e(t).user_id?(m(),k("div",ye,[n(e(W),{date:!0,id:e(t).id},null,8,["id"]),n(x,{size:"small",onClick:o,variant:"plain",icon:"mdi-delete",class:"ml-3"})])):D("",!0)])])])}}}),ke={class:"d-flex flex-column tw-mx-auto"},Ce={class:"d-flex align-center justify-space-between w-100"},Fe=$({__name:"CarRides",setup(V){const r=Y();r.index();const d=O(),s=X();function t(_){r.agRowHeight=_,setTimeout(()=>r.agGrid.resetRowHeights())}const{name:h}=I();E(()=>h.value,_=>{t(B[_])});function y(_){r.agGrid=_.api,r.agColumnApi=_.columnApi,t(B[h.value])}return Q(()=>{r.agGrid=null,r.agColumnApi=null}),(_,z)=>{const u=c("AgGridVue"),o=c("v-spacer");return m(),k("main",ke,[n(e(J),{date:!0}),l("main",Ce,[n(e(Z),{ref_key:"filterComponent",ref:d},null,512),n(e(ee))]),n(o,null,{default:a(()=>[n(u,{class:"ag-theme-ruzzifer ag-theme-alpine h-100",animateRows:!0,defaultColDef:{sortable:!0},rowHeight:e(r).agRowHeight,rowClass:e(r).rowClass,headerHeight:0,columnDefs:e(s),rowData:e(r).rides,onGridReady:y,getRowId:({data:i})=>i.id,doesExternalFilterPass:i=>d.value.filters(i),isExternalFilterPresent:()=>!0},null,8,["rowHeight","rowClass","columnDefs","rowData","getRowId","doesExternalFilterPass"])]),_:1})])}}});export{Fe as default};
