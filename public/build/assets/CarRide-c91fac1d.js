import{G as $,k as l,v as b}from"./app-f25a100e.js";import{h as I}from"./constants-68fdd4d6.js";const k=$("useCarRide",()=>{const s=l(null),r=l(null),u=l(null),i=l([]),o=l([]),c=l(["car-ride-height","tw-shadow","tw-border-l-2","tw-border-pink-500","bg-white","tw-rounded-r","overflow-hidden"]);function f(){axios.get("car-ride").then(({data:e})=>i.value=e)}async function v(e){axios.get(`car-rides/start-region/${e}`).then(({data:a})=>{i.value=a.car_rides,o.value=a.districts})}function p(e){i.value.push(e),s.value!=null&&(s.value.applyTransaction({add:[e],addIndex:0}),s.value.onFilterChanged())}function g(e){const a=i.value.findIndex(t=>t.id==e.id);if(i.value[a]=e,s.value==null)return;s.value.getRowNode(e.id).updateData(e),s.value.onFilterChanged()}function h(e){axios.delete(`car-ride/${e.id}`).then(()=>{i.value=i.value.filter(a=>a.id!=e.id),s.value!=null&&s.value.applyTransaction({remove:[e]})})}async function m(e){await axios.delete(`car-rides/send-road/${e.id}`).then(()=>{i.value=i.value.filter(a=>a.id!=e.id)})}const w=b(()=>{var a;const e={};return(a=o.value)==null||a.forEach(n=>{i.value.forEach(t=>{if(n.id==t.cities[0].district_id){let d=`${t.cities.at(-1).district.region.name} ${t.cities.at(-1).district.name}`;const R=d.split(" ");I(R)&&(d=t.cities.at(-1).district.name),e[n.name]?e[n.name][d]?e[n.name][d].push(t):e[n.name][d]=[t]:(e[n.name]={},e[n.name][d]=[t])}})}),e});function x(e){i.value.find(n=>n.id==e.car_ride_id).passengers.push(e)}function _(e){const a=i.value.find(t=>t.id==e.car_ride_id),n=a.passengers.findIndex(t=>t.id==e.id);a.passengers[n]=e}function y(e){const a=i.value.find(n=>n.id==e.car_ride_id);a.passengers=a.passengers.filter(n=>n.id!=e.id)}function C(){s.value=null,r.value=null,u.value=null,i.value=[],o.value=[],c.value=[]}return{agGrid:s,agColumnApi:r,rides:i,agRowHeight:u,rowClass:c,districts:o,groupRides:w,sendRoad:m,create:p,update:g,destroy:h,index:f,indexCity:v,createPassenger:x,updatePassenger:_,deletedPassenger:y,clear:C}});export{k as u};
