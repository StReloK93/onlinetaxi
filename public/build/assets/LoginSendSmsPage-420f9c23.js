var z=Object.defineProperty;var V=(a,e,t)=>e in a?z(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var r=(a,e,t)=>(V(a,typeof e!="symbol"?e+"":e,t),t);import{r as p,d as M,u as $,j as b,w as _,x as q,f as g,g as x,i as n,l as y,k as w,y as B,m as v,z as j,B as E,C as I,t as k,h as N}from"./app-62f9ceec.js";class D{constructor(e){r(this,"seconds");r(this,"onEnd");r(this,"timerTime");r(this,"interval");this.seconds=p(e),this.timerTime=e,this.start()}start(){this.interval=setInterval(()=>{this.seconds.value--,this.seconds.value==0&&(clearInterval(this.interval),this.onEnd&&this.onEnd())},1e3)}formatted(){const e=this.seconds.value%60,t=Math.floor(this.seconds.value/60),o=e>9?e:`0${e}`;return`${t>9?t:`0${t}`}:${o}`}restart(){this.seconds.value=this.timerTime,this.start()}stop(){this.seconds.value=0,clearInterval(this.interval)}}const P={class:"d-flex w-100"},U=n("h3",{class:"text-h5 font-weight-bold"},"Telefon raqamni tasdiqlash",-1),A={class:"my-2 d-flex align-center justify-between-start"},K={class:"text-caption font-weight-bold text-grey-darken-3"},L={class:"text-red"},Q=n("p",{class:"text-grey-darken-1 w-75"}," Kiritgan raqamingizga tasdiqlovchi maxfiy kod junatildi. ",-1),R={class:"mb-4"},F={key:0},J=M({__name:"LoginSendSmsPage",setup(a){const e=$(),t=p(null),o=new D(300),i=history.state.props.phone,S={mask:"## ###-##-##"},c=p(""),f=p(!1);async function T(){f.value=!0,await e.signIn({code:+c.value,phone:i}).then(d=>{var s,l,u,m;d&&(t.value=(l=(s=d.response)==null?void 0:s.data)==null?void 0:l.message,setTimeout(()=>t.value=null,5e3),((m=(u=d.response)==null?void 0:u.data)==null?void 0:m.code)==2&&o.stop())}),f.value=!1}async function C(){await e.sendSecretCode({phone:i}),o.restart()}return(d,s)=>{const l=g("v-btn"),u=g("v-otp-input"),m=g("v-form");return x(),b(m,{onSubmit:q(T,["prevent"]),class:"text-center d-flex flex-column align-center"},{default:_(()=>[n("div",P,[y(l,{onClick:s[0]||(s[0]=h=>d.$router.go(-1)),icon:"mdi-arrow-left-thin",size:"small",variant:"tonal"})]),U,n("p",A,[n("span",K,[w(" +998 "),B(n("input",{type:"text",style:{width:"90px"},"onUpdate:modelValue":s[1]||(s[1]=h=>I(i)?i.value=h:null),disabled:""},null,512),[[v(j),void 0,S],[E,v(i)]])])]),n("div",L,k(t.value),1),Q,y(u,{modelValue:c.value,"onUpdate:modelValue":s[2]||(s[2]=h=>c.value=h),length:"5"},null,8,["modelValue"]),n("main",R,[v(o).seconds.value!=0?(x(),N("div",F,k(v(o).formatted()),1)):(x(),b(l,{key:1,onClick:C,variant:"tonal",type:"button",size:"x-small"},{default:_(()=>[w("Qayta yuborish")]),_:1}))]),y(l,{type:"submit",loading:f.value,"append-icon":"mdi-login",class:"w-50",disabled:!(c.value.length>4)},{default:_(()=>[w(" Tasdiqlash ")]),_:1},8,["loading","disabled"])]),_:1})}}});export{J as default};
