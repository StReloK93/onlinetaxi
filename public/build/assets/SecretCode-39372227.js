var V=Object.defineProperty;var z=(o,t,e)=>t in o?V(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var d=(o,t,e)=>(z(o,typeof t!="symbol"?t+"":t,e),e);import{k as p,d as M,a as $,c as b,w as _,l as j,r as w,o as g,b as a,e as x,f as y,B as q,g as h,I as B,D as E,J as I,t as k,j as D}from"./app-6e1afd5f.js";class N{constructor(t){d(this,"seconds");d(this,"onEnd");d(this,"timerTime");d(this,"interval");this.seconds=p(t),this.timerTime=t,this.start()}start(){this.interval=setInterval(()=>{this.seconds.value--,this.seconds.value==0&&(clearInterval(this.interval),this.onEnd&&this.onEnd())},1e3)}formatted(){const t=this.seconds.value%60,e=Math.floor(this.seconds.value/60),n=t>9?t:`0${t}`;return`${e>9?e:`0${e}`}:${n}`}restart(){this.seconds.value=this.timerTime,this.start()}stop(){this.seconds.value=0,clearInterval(this.interval)}}const U={class:"d-flex tw-justify-start w-100"},A=a("h3",{class:"text-h5 font-weight-bold"},"Telefon raqamni tasdiqlash",-1),J={class:"my-2 d-flex tw-items-center tw-justify-start"},K={class:"tw-text-sm font-weight-bold text-grey-darken-3"},P={class:"text-red"},Q=a("p",{class:"text-grey-darken-1 w-75"}," Kiritgan raqamingizga tasdiqlovchi maxfiy kod junatildi. ",-1),R={class:"mb-4"},F={key:0},L=M({__name:"SecretCode",setup(o){const t=$(),e=p(null),n=new N(300),i=history.state.props.phone,S={mask:"## ###-##-##"},c=p(""),f=p(!1);async function T(){f.value=!0,await t.login({code:+c.value,phone:i}).then(r=>{var s,l,u,m;r&&(e.value=(l=(s=r.response)==null?void 0:s.data)==null?void 0:l.message,setTimeout(()=>e.value=null,5e3),((m=(u=r.response)==null?void 0:u.data)==null?void 0:m.code)==2&&n.stop())}),f.value=!1}async function C(){await t.sendSecretCode({phone:i}),n.restart()}return(r,s)=>{const l=w("v-btn"),u=w("v-otp-input"),m=w("v-form");return g(),b(m,{onSubmit:j(T,["prevent"]),class:"text-center d-flex flex-column tw-items-center"},{default:_(()=>[a("div",U,[x(l,{onClick:s[0]||(s[0]=v=>r.$router.go(-1)),icon:"mdi-arrow-left-thin",size:"small",variant:"tonal"})]),A,a("p",J,[a("span",K,[y(" +998 "),q(a("input",{type:"text",class:"tw-w-[90px]","onUpdate:modelValue":s[1]||(s[1]=v=>I(i)?i.value=v:null),disabled:""},null,512),[[h(B),void 0,S],[E,h(i)]])])]),a("div",P,k(e.value),1),Q,x(u,{modelValue:c.value,"onUpdate:modelValue":s[2]||(s[2]=v=>c.value=v),length:"5"},null,8,["modelValue"]),a("main",R,[h(n).seconds.value!=0?(g(),D("div",F,k(h(n).formatted()),1)):(g(),b(l,{key:1,onClick:C,variant:"tonal",type:"button",size:"x-small"},{default:_(()=>[y("Qayta yuborish")]),_:1}))]),x(l,{type:"submit",loading:f.value,"append-icon":"mdi-login",class:"w-50",disabled:!(c.value.length>4)},{default:_(()=>[y(" Tasdiqlash ")]),_:1},8,["loading","disabled"])]),_:1})}}});export{L as default};
