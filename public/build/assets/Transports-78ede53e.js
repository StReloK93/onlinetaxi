import{C as I,k,d as C,q as M,p as D,r as d,A as q,o as f,c as w,w as l,f as r,e as p,g as x,h as _,B as T,n as h,i as z,x as j,a as E,j as F,t as $,b as H}from"./app-f063963f.js";import{r as A}from"./constants-68fdd4d6.js";const U=I("useTransport",()=>{const g=k(null),v=k(null),c=k([]);function e(o){g.value.getRowNode(o.id).setData(o)}function a(){axios.get("user-cars/get-only-my").then(({data:o})=>c.value=o)}function u(o){axios.delete(`user-car/${o.id}`).then(()=>{c.value=c.value.filter(t=>t.id!=o.id),g.value!=null&&g.value.applyTransaction({remove:[o]})})}return{agGrid:g,agColumnApi:v,transports:c,update:e,getTransports:a,destroy:u}}),P={class:"text-caption"},Z=p("span",{class:"text-blue-grey-lighten-1"}," Agarda sizning transportingiz ro'yhatda yo'q bo'lsa adminga murojat qiling! ",-1),O={class:"d-flex justify-space-between mb-2"},Y=p("img",{src:"/iconos/uz.png",class:"tw-w-3 tw-absolute tw-right-0.5 tw-top-0.5"},null,-1),J=p("img",{src:"/iconos/uz.png",class:"tw-w-3 tw-absolute tw-right-0.5 tw-top-0.5"},null,-1),N=C({__name:"Inputs",setup(g,{expose:v}){const c=M(()=>{const o={mask:"## A ### AA",tokens:{A:{pattern:/[A-Z]/,transform:s=>s.toUpperCase()}}},t={mask:"## ### AAA",tokens:{A:{pattern:/[A-Z]/,transform:s=>s.toUpperCase()}}};return e.number_variant?o:t}),e=D({car_company_id:null,car_id:null,number:null,fuel_type:null,trunk:!1,number_variant:!0}),a=D({car_company:[],fuel_types:[],cars:[],car_input_loading:!1});async function u(o){a.car_input_loading=!0,e.car_id=null,await axios.get(`car/${o}`).then(({data:t})=>{a.cars=t}),a.car_input_loading=!1}return axios.all([axios.get("fuel_type"),axios.get("car-company")]).then(axios.spread(({data:o},{data:t})=>{a.fuel_types=o,a.car_company=t})),v({formData:e,carMarkChanged:u}),(o,t)=>{const s=d("v-icon"),n=d("v-col"),m=d("v-select"),b=d("v-label"),V=d("v-sheet"),y=d("v-text-field"),G=d("v-switch"),R=d("v-row"),B=q("ripple"),S=q("maska");return f(),w(R,null,{default:l(()=>[r(n,{cols:"12"},{default:l(()=>[p("p",P,[r(s,{class:"mr-2",color:"primary"},{default:l(()=>[x(" mdi-bell ")]),_:1}),Z])]),_:1}),r(n,{sm:"6",cols:"12"},{default:l(()=>[r(m,{"onUpdate:modelValue":[t[0]||(t[0]=i=>u(i)),t[1]||(t[1]=i=>e.car_company_id=i)],items:a.car_company,modelValue:e.car_company_id,label:"Transport markasi","item-title":"name","item-value":i=>i.id,rules:_(A)},null,8,["items","modelValue","item-value","rules"])]),_:1}),r(n,{sm:"6",cols:"12"},{default:l(()=>[r(m,{disabled:e.car_company_id==null,items:a.cars,modelValue:e.car_id,"onUpdate:modelValue":t[2]||(t[2]=i=>e.car_id=i),label:"Transport turi","item-title":"name","item-value":i=>i.id,rules:_(A),loading:a.car_input_loading},null,8,["disabled","items","modelValue","item-value","rules","loading"])]),_:1}),r(n,{sm:"6",cols:"12",class:"py-0"},{default:l(()=>[r(b,{class:"tw-text-xs"},{default:l(()=>[x(" Transport raqami turini tanlang ")]),_:1}),p("div",O,[T((f(),w(V,{onClick:t[3]||(t[3]=i=>e.number_variant=!0),class:h([{"tw-bg-pink-50 !tw-border-pink-600":e.number_variant},"tw-border rounded tw-border-gray-600 d-flex tw-relative"]),height:26},{default:l(()=>[p("div",{class:h([{"!tw-border-pink-600":e.number_variant},"d-flex justify-center align-center tw-w-7 tw-border tw-border-gray-600"])},[e.number_variant?(f(),w(s,{key:0,color:"primary",size:"small"},{default:l(()=>[x(" mdi-check ")]),_:1})):z("",!0)],2),p("div",{class:h([{"!tw-border-pink-600":e.number_variant},"d-flex justify-space-between align-center pl-1 pr-4 tw-border tw-border-gray-600 flex-grow-1"])},[x(" A 000 AA "),Y],2)]),_:1},8,["class"])),[[B]]),T((f(),w(V,{onClick:t[4]||(t[4]=i=>e.number_variant=!1),class:h([{"tw-bg-pink-50 !tw-border-pink-600":!e.number_variant},"tw-border rounded tw-border-gray-600 d-flex tw-relative"]),height:26},{default:l(()=>[p("div",{class:h([{"!tw-border-pink-600":!e.number_variant},"d-flex justify-center align-center tw-w-7 tw-border tw-border-gray-600"])},[e.number_variant?z("",!0):(f(),w(s,{key:0,color:"primary",size:"small"},{default:l(()=>[x(" mdi-check ")]),_:1}))],2),p("div",{class:h([{"!tw-border-pink-600":!e.number_variant},"d-flex justify-space-between align-center pl-1 pr-4 tw-border tw-border-gray-600 flex-grow-1"])},[x(" 000 AAA "),J],2)]),_:1},8,["class"])),[[B]])])]),_:1}),r(n,{sm:"6",cols:"12"},{default:l(()=>[T(r(y,{modelValue:e.number,"onUpdate:modelValue":t[5]||(t[5]=i=>e.number=i),label:"Transport raqamini kiriting",rules:_(A)},null,8,["modelValue","rules"]),[[S,void 0,c.value]])]),_:1}),r(n,{sm:"6",cols:"12"},{default:l(()=>[r(m,{items:a.fuel_types,modelValue:e.fuel_type,"onUpdate:modelValue":t[6]||(t[6]=i=>e.fuel_type=i),label:"Yoqilg'i turi","item-title":"name","item-value":i=>i.id,rules:_(A)},null,8,["items","modelValue","item-value","rules"])]),_:1}),r(n,{sm:"6",cols:"12"},{default:l(()=>[r(G,{modelValue:e.trunk,"onUpdate:modelValue":t[7]||(t[7]=i=>e.trunk=i),label:"Bagaj",class:"px-2"},null,8,["modelValue"])]),_:1})]),_:1})}}}),K=C({__name:"Add",emits:["create"],setup(g,{emit:v}){const c=v,e=k(),a=D({dialog:!1});async function u(){const o=e.value.formData;await axios.post("user-car",o).then(({data:t})=>{c("create",t),a.dialog=!1})}return(o,t)=>{const s=d("v-btn"),n=d("CustomForm"),m=d("v-dialog");return f(),w(m,{modelValue:a.dialog,"onUpdate:modelValue":t[1]||(t[1]=b=>a.dialog=b),scrollable:"",width:"600px"},{activator:l(({props:b})=>[r(s,j({color:"primary"},b,{icon:"mdi-plus",class:"add-button"}),null,16)]),default:l(()=>[r(n,{submit:u,title:"Transport kiritish",onClose:t[0]||(t[0]=b=>a.dialog=!1)},{default:l(()=>[r(N,{ref_key:"inputComponent",ref:e},null,512)]),_:1})]),_:1},8,["modelValue"])}}}),L=C({__name:"Edit",props:["smButton","id"],emits:["update"],setup(g,{emit:v}){const c=U(),e=k(),a=g,u=D({dialog:!1});async function o(){const s=e.value.formData;await axios.put(`user-car/${a.id}`,s).then(({data:n})=>c.update(n))}function t(s){axios.get(`user-car/${s}`).then(({data:n})=>{const m=e.value.formData;m.number=n.number,m.fuel_type=n.fuel_type,m.number_variant=n.number_variant,m.car_company_id=n.car.car_company_id,m.trunk=!!n.trunk,e.value.carMarkChanged(m.car_company_id).then(()=>{m.car_id=n.car_id})})}return(s,n)=>{const m=d("v-btn"),b=d("CustomForm"),V=d("v-dialog");return f(),w(V,{modelValue:u.dialog,"onUpdate:modelValue":n[2]||(n[2]=y=>u.dialog=y),scrollable:"",width:"600px"},{activator:l(({props:y})=>[a.smButton?(f(),w(m,j({key:0},y,{"prepend-icon":"mdi-pencil",size:"x-small",variant:"tonal",color:"white"}),{default:l(()=>[x(" O'zgaritirish ")]),_:2},1040)):(f(),w(m,j({key:1,size:"small"},y,{variant:"plain",icon:"mdi-pencil"}),null,16))]),default:l(()=>[r(b,{submit:o,title:"Transportni tahrirlash",onVnodeMounted:n[0]||(n[0]=y=>t(a.id)),onClose:n[1]||(n[1]=y=>u.dialog=!1)},{default:l(()=>[r(N,{ref_key:"inputComponent",ref:e},null,512)]),_:1},512)]),_:1},8,["modelValue"])}}}),Q={class:"px-2 w-100 d-flex flex-column"},W={class:"d-flex justify-space-between flex-grow-1 pt-1"},X={class:"tw-uppercase tw-text-3xl text-primary tw-leading-none"},ee={class:"tw-text-sm tw-text-gray-600 tw-leading-none"},te={class:"d-flex justify-space-between align-center"},ae={class:"tw-text-base tw-font-semibold tw-text-gray-600"},ne=C({__name:"TransportRenderer",props:["params"],setup(g){const v=U(),e=g.params.data,a=E();function u(){a.dialog.open(()=>{a.dialog.title="Transportni o'chirmoqchimisiz ?",a.dialog.subTitle="Ushbu transportga tegishli barcha qatnovlar ham o'chib ketadi.",a.dialog.submit=()=>v.destroy(e)})}return(o,t)=>{const s=d("v-btn");return f(),F("section",Q,[p("aside",W,[p("main",null,[p("h3",X,$(_(e).car.name),1),p("div",ee,$(_(e).car.company.name),1)])]),p("div",te,[p("h3",ae,$(_(e).number),1),p("span",null,[r(L,{id:_(e).id},null,8,["id"]),r(s,{size:"small",onClick:u,variant:"plain",icon:"mdi-delete"})])])])}}}),oe=[{cellRenderer:ne,flex:1,valueFormatter:null,cellClass:["px-0","align-stretch"]}],re={class:"d-flex tw-flex-col"},ie=C({__name:"Transports",setup(g){const v=H(),c=U();c.getTransports();const e=k(["!tw-h-28","tw-shadow","tw-border-l-2","tw-border-pink-500","bg-white","tw-rounded-r","overflow-hidden"]);return(a,u)=>{const o=d("AgGridVue"),t=d("v-spacer");return f(),F("main",re,[[1,2,4].includes(_(v).user.role_id)?(f(),w(_(K),{key:0,onCreate:u[0]||(u[0]=s=>_(c).agGrid.applyTransaction({add:[s],addIndex:0}))})):z("",!0),r(t,null,{default:l(()=>[r(o,{class:"ag-theme-ruzzifer ag-theme-alpine h-100",rowHeight:125,rowClass:e.value,headerHeight:0,columnDefs:_(oe),rowData:_(c).transports,onGridReady:u[1]||(u[1]=s=>_(c).agGrid=s.api),getRowId:({data:s})=>s.id},null,8,["rowClass","columnDefs","rowData","getRowId"])]),_:1})])}}});export{ie as default};
