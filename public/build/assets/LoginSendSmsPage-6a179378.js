import{k as h,d as z,b as C,r as p,o as f,c as x,w as _,e as s,f as g,g as w,x as V,h as m,z as M,A as $,t as y,s as q,v as j,y as B}from"./app-9d059da3.js";class E{constructor(t){this.seconds=h(t),this.timerTime=t,this.start()}start(){this.interval=setInterval(()=>{this.seconds.value--,this.seconds.value==0&&(clearInterval(this.interval),this.onEnd&&this.onEnd())},1e3)}formatted(){const t=this.seconds.value%60,a=Math.floor(this.seconds.value/60),o=t>9?t:`0${t}`;return`${a>9?a:`0${a}`}:${o}`}restart(){this.seconds.value=this.timerTime,this.start()}stop(){this.seconds.value=0,clearInterval(this.interval)}}const I={class:"d-flex tw-justify-start w-100"},N=s("h3",{class:"text-h5 font-weight-bold"},"Telefon raqamni tasdiqlash",-1),A={class:"my-2 d-flex tw-items-center tw-justify-start"},D={class:"tw-text-sm font-weight-bold text-grey-darken-3"},P={class:"text-red"},U=s("p",{class:"text-grey-darken-1 w-75"}," Kiritgan raqamingizga tasdiqlovchi maxfiy kod junatildi. ",-1),K={class:"mb-4"},L={key:0},R=z({__name:"LoginSendSmsPage",setup(b){const t=C(),a=h(null),o=new E(300),n=history.state.props.phone,k={mask:"## ###-##-##"},r=h(""),v=h(!1);async function S(){v.value=!0,await t.login({code:+r.value,phone:n}).then(l=>{var e,i,d,c;l&&(a.value=(i=(e=l.response)==null?void 0:e.data)==null?void 0:i.message,setTimeout(()=>a.value=null,5e3),((c=(d=l.response)==null?void 0:d.data)==null?void 0:c.code)==2&&o.stop())}),v.value=!1}async function T(){await t.sendSecretCode({phone:n}),o.restart()}return(l,e)=>{const i=p("v-btn"),d=p("v-otp-input"),c=p("v-form");return f(),x(c,{onSubmit:j(S,["prevent"]),class:"text-center d-flex flex-column tw-items-center"},{default:_(()=>[s("div",I,[g(i,{onClick:e[0]||(e[0]=u=>l.$router.go(-1)),icon:"mdi-arrow-left-thin",size:"small",variant:"tonal"})]),N,s("p",A,[s("span",D,[w(" +998 "),V(s("input",{type:"text",class:"tw-w-[90px]","onUpdate:modelValue":e[1]||(e[1]=u=>$(n)?n.value=u:null),disabled:""},null,512),[[m(B),void 0,k],[M,m(n)]])])]),s("div",P,y(a.value),1),U,g(d,{modelValue:r.value,"onUpdate:modelValue":e[2]||(e[2]=u=>r.value=u),length:"5"},null,8,["modelValue"]),s("main",K,[m(o).seconds.value!=0?(f(),q("div",L,y(m(o).formatted()),1)):(f(),x(i,{key:1,onClick:T,variant:"tonal",type:"button",size:"x-small"},{default:_(()=>[w("Qayta yuborish")]),_:1}))]),g(i,{type:"submit",loading:v.value,"append-icon":"mdi-login",class:"w-50",disabled:!(r.value.length>4)},{default:_(()=>[w(" Tasdiqlash ")]),_:1},8,["loading","disabled"])]),_:1})}}});export{R as default};
