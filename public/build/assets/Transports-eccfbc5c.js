import{C as R,k,d as h,q as S,p as V,r as c,A as U,o as v,c as x,w as i,f as s,e as p,g as B,h as _,B as D,n as y,v as $,a as I,j as q,t as T,b as M,i as E}from"./app-0ba38769.js";import{r as C}from"./constants-68fdd4d6.js";const j=R("useTransport",()=>{const f=k(null),g=k(null),u=k([]);function e(n){f.value.getRowNode(n.id).setData(n)}function a(){axios.get("user-cars/get-only-my").then(({data:n})=>u.value=n)}function d(n){axios.delete(`user-car/${n.id}`).then(()=>{u.value=u.value.filter(t=>t.id!=n.id),f.value!=null&&f.value.applyTransaction({remove:[n]})})}return{agGrid:f,agColumnApi:g,transports:u,update:e,getTransports:a,destroy:d}}),H={class:"text-caption"},P=p("span",{class:"text-blue-grey-lighten-1"}," Agarda sizning transportingiz ro'yhatda yo'q bo'lsa adminga murojat qiling! ",-1),Z={class:"d-flex justify-space-between mb-2"},F=h({__name:"Inputs",setup(f,{expose:g}){const u=S(()=>{const n={mask:"## A ### AA",tokens:{A:{pattern:/[A-Z]/,transform:r=>r.toUpperCase()}}},t={mask:"## ### AAA",tokens:{A:{pattern:/[A-Z]/,transform:r=>r.toUpperCase()}}};return e.number_variant?n:t}),e=V({car_company_id:null,car_id:null,number:null,fuel_type:null,trunk:!1,number_variant:!0}),a=V({car_company:[],fuel_types:[],cars:[],car_input_loading:!1});async function d(n){a.car_input_loading=!0,e.car_id=null,await axios.get(`car/${n}`).then(({data:t})=>{a.cars=t}),a.car_input_loading=!1}return axios.all([axios.get("fuel_type"),axios.get("car-company")]).then(axios.spread(({data:n},{data:t})=>{a.fuel_types=n,a.car_company=t})),g({formData:e,carMarkChanged:d}),(n,t)=>{const r=c("v-icon"),o=c("v-col"),m=c("v-select"),b=c("v-sheet"),A=c("v-text-field"),w=c("v-switch"),N=c("v-row"),z=U("ripple"),G=U("maska");return v(),x(N,null,{default:i(()=>[s(o,{cols:"12"},{default:i(()=>[p("p",H,[s(r,{class:"mr-2",color:"primary"},{default:i(()=>[B(" mdi-bell ")]),_:1}),P])]),_:1}),s(o,{sm:"6",cols:"12"},{default:i(()=>[s(m,{"onUpdate:modelValue":[t[0]||(t[0]=l=>d(l)),t[1]||(t[1]=l=>e.car_company_id=l)],items:a.car_company,modelValue:e.car_company_id,label:"Transport markasi","item-title":"name","item-value":l=>l.id,rules:_(C)},null,8,["items","modelValue","item-value","rules"])]),_:1}),s(o,{sm:"6",cols:"12"},{default:i(()=>[s(m,{disabled:e.car_company_id==null,items:a.cars,modelValue:e.car_id,"onUpdate:modelValue":t[2]||(t[2]=l=>e.car_id=l),label:"Transport turi","item-title":"name","item-value":l=>l.id,rules:_(C),loading:a.car_input_loading},null,8,["disabled","items","modelValue","item-value","rules","loading"])]),_:1}),s(o,{sm:"6",cols:"12"},{default:i(()=>[p("div",Z,[D((v(),x(b,{onClick:t[3]||(t[3]=l=>e.number_variant=!0),class:y([{"tw-bg-pink-50 tw-border-pink-600":e.number_variant},"tw-border rounded tw-border-gray-700 d-flex"]),height:26},{default:i(()=>[p("div",{class:y([{"tw-border-pink-600":e.number_variant},"d-flex justify-space-between align-center px-2 tw-border tw-border-gray-700"])}," 00 ",2),p("div",{class:y([{"tw-border-pink-600":e.number_variant},"d-flex justify-space-between align-center px-2 tw-border tw-border-gray-700 flex-grow-1"])}," A 000 AA ",2)]),_:1},8,["class"])),[[z]]),D((v(),x(b,{onClick:t[4]||(t[4]=l=>e.number_variant=!1),class:y([{"tw-bg-pink-50 tw-border-pink-600":!e.number_variant},"tw-border rounded tw-border-gray-700 d-flex"]),height:26},{default:i(()=>[p("div",{class:y([{"tw-border-pink-600":!e.number_variant},"d-flex justify-space-between align-center px-2 tw-border tw-border-gray-700"])}," 00 ",2),p("div",{class:y([{"tw-border-pink-600":!e.number_variant},"d-flex justify-space-between align-center px-2 tw-border tw-border-gray-700 flex-grow-1"])}," 000 AAA ",2)]),_:1},8,["class"])),[[z]])]),D(s(A,{modelValue:e.number,"onUpdate:modelValue":t[5]||(t[5]=l=>e.number=l),label:"Transport raqami",rules:_(C)},null,8,["modelValue","rules"]),[[G,void 0,u.value]])]),_:1}),s(o,{sm:"6",cols:"12"},{default:i(()=>[s(m,{items:a.fuel_types,modelValue:e.fuel_type,"onUpdate:modelValue":t[6]||(t[6]=l=>e.fuel_type=l),label:"Yoqilg'i turi","item-title":"name","item-value":l=>l.id,rules:_(C)},null,8,["items","modelValue","item-value","rules"])]),_:1}),s(o,{sm:"6",cols:"12"},{default:i(()=>[s(w,{modelValue:e.trunk,"onUpdate:modelValue":t[7]||(t[7]=l=>e.trunk=l),label:"Bagaj",class:"px-2"},null,8,["modelValue"])]),_:1})]),_:1})}}}),O=h({__name:"Add",emits:["create"],setup(f,{emit:g}){const u=g,e=k(),a=V({dialog:!1});async function d(){const n=e.value.formData;await axios.post("user-car",n).then(({data:t})=>{u("create",t),a.dialog=!1})}return(n,t)=>{const r=c("v-btn"),o=c("CustomForm"),m=c("v-dialog");return v(),x(m,{modelValue:a.dialog,"onUpdate:modelValue":t[1]||(t[1]=b=>a.dialog=b),scrollable:"",persistent:"",width:"600px"},{activator:i(({props:b})=>[s(r,$({color:"primary"},b,{icon:"mdi-plus",class:"add-button"}),null,16)]),default:i(()=>[s(o,{submit:d,title:"Transport kiritish",onClose:t[0]||(t[0]=b=>a.dialog=!1)},{default:i(()=>[s(F,{ref_key:"inputComponent",ref:e},null,512)]),_:1})]),_:1},8,["modelValue"])}}}),Y=h({__name:"Edit",props:["smButton","id"],emits:["update"],setup(f,{emit:g}){const u=j(),e=k(),a=f,d=V({dialog:!1});async function n(){const r=e.value.formData;await axios.put(`user-car/${a.id}`,r).then(({data:o})=>u.update(o))}function t(r){axios.get(`user-car/${r}`).then(({data:o})=>{const m=e.value.formData;m.number=o.number,m.fuel_type=o.fuel_type,m.car_company_id=o.car.car_company_id,m.trunk=!!o.trunk,e.value.carMarkChanged(m.car_company_id).then(()=>{m.car_id=o.car_id})})}return(r,o)=>{const m=c("v-btn"),b=c("CustomForm"),A=c("v-dialog");return v(),x(A,{modelValue:d.dialog,"onUpdate:modelValue":o[2]||(o[2]=w=>d.dialog=w),scrollable:"",persistent:"",width:"600px"},{activator:i(({props:w})=>[a.smButton?(v(),x(m,$({key:0},w,{"prepend-icon":"mdi-pencil",size:"x-small",variant:"tonal",color:"white"}),{default:i(()=>[B(" O'zgaritirish ")]),_:2},1040)):(v(),x(m,$({key:1,size:"small"},w,{variant:"plain",icon:"mdi-pencil"}),null,16))]),default:i(()=>[s(b,{submit:n,title:"Transportni tahrirlash",onVnodeMounted:o[0]||(o[0]=w=>t(a.id)),onClose:o[1]||(o[1]=w=>d.dialog=!1)},{default:i(()=>[s(F,{ref_key:"inputComponent",ref:e},null,512)]),_:1},512)]),_:1},8,["modelValue"])}}}),J={class:"px-2 w-100 d-flex flex-column"},K={class:"d-flex justify-space-between flex-grow-1"},L={class:"tw-uppercase tw-text-3xl text-primary"},Q={class:"tw-text-sm tw-text-gray-600"},W={class:"d-flex justify-space-between align-center"},X={class:"tw-text-base tw-font-semibold tw-text-gray-600"},ee=h({__name:"TransportRenderer",props:["params"],setup(f){const g=j(),e=f.params.data,a=I();function d(){a.dialog.open(()=>{a.dialog.title="Transportni o'chirmoqchimisiz ?",a.dialog.subTitle="Ushbu transportga tegishli barcha qatnovlar ham o'chib ketadi.",a.dialog.submit=()=>g.destroy(e)})}return(n,t)=>{const r=c("v-btn");return v(),q("section",J,[p("aside",K,[p("main",null,[p("h3",L,T(_(e).car.name),1),p("div",Q,T(_(e).car.company.name),1)])]),p("div",W,[p("h3",X,T(_(e).number),1),p("span",null,[s(Y,{id:_(e).id},null,8,["id"]),s(r,{size:"small",onClick:d,variant:"plain",icon:"mdi-delete"})])])])}}}),te=[{cellRenderer:ee,flex:1,valueFormatter:null,cellClass:["px-0","align-stretch"]}],ae={class:"d-flex tw-flex-col"},se=h({__name:"Transports",setup(f){const g=M(),u=j();u.getTransports();const e=k(["!tw-h-28","tw-shadow","tw-border-l-2","tw-border-pink-500","bg-white","tw-rounded-r","overflow-hidden"]);return(a,d)=>{const n=c("AgGridVue"),t=c("v-spacer");return v(),q("main",ae,[[1,2,4].includes(_(g).user.role_id)?(v(),x(_(O),{key:0,onCreate:d[0]||(d[0]=r=>_(u).agGrid.applyTransaction({add:[r],addIndex:0}))})):E("",!0),s(t,null,{default:i(()=>[s(n,{class:"ag-theme-ruzzifer ag-theme-alpine h-100",rowHeight:125,rowClass:e.value,headerHeight:0,columnDefs:_(te),rowData:_(u).transports,onGridReady:d[1]||(d[1]=r=>_(u).agGrid=r.api),getRowId:({data:r})=>r.id},null,8,["rowClass","columnDefs","rowData","getRowId"])]),_:1})])}}});export{se as default};
