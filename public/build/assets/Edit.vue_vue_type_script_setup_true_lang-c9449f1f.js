import{r as b,p as W,m as P}from"./constants-68fdd4d6.js";import{d as N,j as Q,p as z,r,B as R,o as m,c as p,w as n,f as a,l as C,i as F,x as X,F as T,h as g,e as D,C as Y,D as Z,g as U,n as ee,v as M,S as j}from"./app-ffab9f92.js";import{u as A}from"./CarRide-01b13d09.js";const te={key:0,class:"v-messages text-error font-weight-regular pb-2 !tw-opacity-100"},le=D("div",{class:"v-messages__message"},"To'ldiring",-1),ae=[le],oe={class:"d-flex w-100 mb-3"},ne=D("img",{src:"/iconos/uz.png"},null,-1),E=N({__name:"Inputs",props:["edit","date"],setup(h,{expose:k}){const _=Q(!1),e=z({car_id:null,phone:null,strictly_on_time:!1,address_to_address:!1,ends:[{region:null,city:null,loading:!1,districts:[]},{region:null,city:null,loading:!1,districts:[]}],ride_time:null,price:"",free_seat:null}),s=z({overlay:!0,cars:[],regions:[]});function x(){e.ends.length!=4&&e.ends.splice(1,0,{region:null,city:null,loading:!1,districts:[]})}function y(d){e.ends.splice(d,1)}function u(d){const t=s.cars.find(c=>c.id==d);e.phone=t.user.phone}async function o(d,t){e.ends[t].loading=!0,e.ends[t].city=null,e.ends[t].districts=[],await axios.get(`district/${d}`).then(({data:c})=>{e.ends[t].districts=c,e.ends[t].loading=!1})}function i(){s.overlay=!1}return axios.all([axios.get("cars/get_only_my"),axios.get("region")]).then(axios.spread(({data:d},{data:t})=>{s.cars=d,s.regions=t})),k({regionChanged:o,formData:e,clearOverlay:i}),(d,t)=>{const c=r("v-progress-circular"),H=r("v-overlay"),B=r("v-label"),q=r("v-btn"),V=r("v-col"),$=r("v-autocomplete"),I=r("v-divider"),S=r("VDatePicker"),w=r("v-text-field"),L=r("v-icon"),O=r("v-switch"),G=r("v-row"),J=R("maska"),K=R("money3");return m(),p(G,null,{default:n(()=>[h.edit?(m(),p(H,{key:0,modelValue:s.overlay,"onUpdate:modelValue":t[0]||(t[0]=l=>s.overlay=l),contained:"",persistent:"",class:"align-center justify-center"},{default:n(()=>[a(c,{color:"primary",indeterminate:"",size:68})]),_:1},8,["modelValue"])):C("",!0),(m(!0),F(T,null,X(e.ends,(l,v)=>(m(),F(T,null,[v==0?(m(),p(V,{key:0,cols:"12",class:"py-2 text-center"},{default:n(()=>[a(B,{class:"text-caption mr-3"},{default:n(()=>[U(" Boshlang'ich manzil (Qaerdan?) ")]),_:1}),a(q,{size:"x-small",onClick:x,disabled:e.ends.length==4,icon:"mdi-plus",variant:"plain"},null,8,["disabled"])]),_:1})):C("",!0),[1].includes(v)&&v!=e.ends.length-1?(m(),p(V,{key:1,cols:"12",class:"py-0 text-center"},{default:n(()=>[a(B,{class:"text-caption"},{default:n(()=>[U(" Oraliq manzillar ")]),_:1})]),_:1})):C("",!0),e.ends.length==v+1?(m(),p(V,{key:2,cols:"12",class:"py-0 text-center"},{default:n(()=>[a(B,{class:"text-caption"},{default:n(()=>[U(" Boriladigan manzil (Qaerga?) ")]),_:1})]),_:1})):C("",!0),D("div",{class:ee(["w-100 d-flex flex-wrap",{"px-0":[1,2].includes(v)&&v!=e.ends.length-1}])},[a(V,{sm:"6",cols:"12"},{default:n(()=>[a($,{modelValue:l.region,"onUpdate:modelValue":[f=>l.region=f,f=>o(f,v)],items:s.regions,label:"Viloyat","item-title":"name","item-value":f=>f.id,rules:g(b)},null,8,["modelValue","onUpdate:modelValue","items","item-value","rules"])]),_:2},1024),a(V,{sm:"6",cols:"12",class:"d-flex align-center"},{default:n(()=>[a($,{disabled:l.region==null,modelValue:l.city,"onUpdate:modelValue":f=>l.city=f,items:l.districts,label:"Shahar (Tuman)","item-title":"name","item-value":f=>f.id,loading:l.loading,rules:g(b)},null,8,["disabled","modelValue","onUpdate:modelValue","items","item-value","loading","rules"]),[1,2].includes(v)&&v!=e.ends.length-1?(m(),p(q,{key:0,onClick:f=>y(v),size:"x-small",icon:"mdi-minus",class:"ml-2",variant:"plain"},null,8,["onClick"])):C("",!0)]),_:2},1024)],2)],64))),256)),a(I,{class:"border-opacity-75"}),h.date?(m(),p(V,{key:1,sm:"6",cols:"12"},{default:n(()=>[a(S,{color:"pink","min-date":new Date,modelValue:e.ride_time,"onUpdate:modelValue":t[1]||(t[1]=l=>e.ride_time=l),modelModifiers:{string:!0},masks:{modelValue:"YYYY-MM-DD HH:mm"},mode:"datetime",transparent:"",borderless:"",expanded:"",is24hr:"","hide-time-header":"","is-required":""},null,8,["min-date","modelValue"]),a(w,{class:"hidden tw-relative -tw-top-20",modelValue:e.ride_time,"onUpdate:modelValue":t[2]||(t[2]=l=>e.ride_time=l),rules:g(b),readonly:""},null,8,["modelValue","rules"]),_.value?(m(),F("div",te,ae)):C("",!0)]),_:1})):C("",!0),a(V,{sm:"6",cols:"12"},{default:n(()=>[a($,{class:"mb-3","onUpdate:modelValue":[u,t[3]||(t[3]=l=>e.car_id=l)],items:s.cars,modelValue:e.car_id,label:"Avtomobil","item-title":l=>l.type+" "+l.number,"item-value":l=>l.id,rules:g(b)},null,8,["items","modelValue","item-title","item-value","rules"]),D("main",oe,[a(w,{class:"pr-2 flex-0-0",readonly:"",density:"compact",value:"+998",disabled:""},{"prepend-inner":n(()=>[a(L,null,{default:n(()=>[ne]),_:1})]),_:1}),Y(a(w,{modelValue:e.phone,"onUpdate:modelValue":t[4]||(t[4]=l=>e.phone=l),density:"compact",rules:g(b)},null,8,["modelValue","rules"]),[[J,void 0,g(W)]])]),a(w,{label:"Narxi",rules:g(b),modelValue:e.price,"onUpdate:modelValue":t[5]||(t[5]=l=>e.price=l),modelModifiers:{lazy:!0},class:"mb-3"},null,8,["rules","modelValue"]),a(w,{modelValue:e.free_seat,"onUpdate:modelValue":t[6]||(t[6]=l=>e.free_seat=l),type:"number",label:"Bosh o'rindiqlar",class:"mb-3",rules:g(b)},null,8,["modelValue","rules"]),Y(D("input",{"onUpdate:modelValue":t[7]||(t[7]=l=>e.price=l),type:"text",hidden:""},null,512),[[K,g(P)],[Z,e.price,void 0,{lazy:!0}]]),a(O,{modelValue:e.strictly_on_time,"onUpdate:modelValue":t[8]||(t[8]=l=>e.strictly_on_time=l),label:"Qat'iy shu vaqtda"},null,8,["modelValue"]),a(O,{modelValue:e.address_to_address,"onUpdate:modelValue":t[9]||(t[9]=l=>e.address_to_address=l),label:"Manzilgacha"},null,8,["modelValue"])]),_:1})]),_:1})}}}),de=N({__name:"Add",props:["date","btnClass"],setup(h){const k=A(),_=h,e=Q(),s=z({dialog:!1});async function x(){const y=e.value.formData;y.price=j(y.price,P),await axios.post("car-ride",y).then(({data:u})=>k.create(u))}return(y,u)=>{const o=r("v-btn"),i=r("CustomForm"),d=r("v-dialog");return m(),p(d,{modelValue:s.dialog,"onUpdate:modelValue":u[1]||(u[1]=t=>s.dialog=t),scrollable:"",persistent:"",width:"600px"},{activator:n(({props:t})=>[a(o,M({color:"primary"},t,{icon:"mdi-plus",class:[_.btnClass,"add-button"]}),null,16,["class"])]),default:n(()=>[a(i,{submit:x,title:"Qatnov kiritish",onClose:u[0]||(u[0]=t=>s.dialog=!1)},{default:n(()=>[a(E,{ref_key:"inputComponent",ref:e,date:_.date},null,8,["date"])]),_:1})]),_:1},8,["modelValue"])}}}),ue=N({__name:"Edit",props:["date","id","smButton"],setup(h){const k=A(),_=Q(),e=h,s=z({dialog:!1,car_ride:null});async function x(){const u=_.value.formData;u.price=j(u.price,P),await axios.put(`car-ride/${s.car_ride.id}`,u).then(async({data:o})=>{k.update(o),s.dialog=!1})}function y(u){axios.get(`car-ride/${u}`).then(async({data:o})=>{s.car_ride=o;const i=_.value.formData;i.car_id=o.car_id,i.phone=o.phone,i.ride_time=o.ride_time,i.strictly_on_time=o.strictly_on_time,i.price=o.price,i.address_to_address=o.address_to_address,i.free_seat=o.free_seat,i.ends=[],await Promise.all(o.cities.map(async(d,t)=>{i.ends.push({region:null,city:null,loading:!1,districts:[]}),await _.value.regionChanged(d.district.region_id,t),i.ends[t].region=d.district.region_id,i.ends[t].city=d.district_id,_.value.clearOverlay()}))})}return(u,o)=>{const i=r("v-btn"),d=r("CustomForm"),t=r("v-dialog");return m(),p(t,{modelValue:s.dialog,"onUpdate:modelValue":o[2]||(o[2]=c=>s.dialog=c),scrollable:"",persistent:"",width:"600px"},{activator:n(({props:c})=>[e.smButton?(m(),p(i,M({key:0},c,{"prepend-icon":"mdi-pencil",size:"x-small",variant:"tonal",color:"white"}),{default:n(()=>[U(" O'zgaritirish ")]),_:2},1040)):(m(),p(i,M({key:1,size:"small"},c,{variant:"plain",icon:"mdi-pencil"}),null,16))]),default:n(()=>[a(d,{submit:x,onVnodeMounted:o[0]||(o[0]=c=>y(e.id)),title:"Qatnovni tahrirlash",onClose:o[1]||(o[1]=c=>s.dialog=!1)},{default:n(()=>[a(E,{ref_key:"inputComponent",ref:_,edit:!0,date:e.date},null,8,["date"])]),_:1},512)]),_:1},8,["modelValue"])}}});export{ue as _,de as a};
