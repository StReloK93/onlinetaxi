import{r as m,d as T,u as V,f as p,g as f,j as y,w as _,i as s,l as g,k as x,y as z,m as h,B as M,C as $,t as w,h as q,v as B,A as j}from"./app-d31b02d9.js";class I{constructor(e){this.seconds=m(e),this.timerTime=e,this.start()}start(){this.interval=setInterval(()=>{this.seconds.value--,this.seconds.value==0&&(clearInterval(this.interval),this.onEnd&&this.onEnd())},1e3)}formatted(){const e=this.seconds.value%60,n=Math.floor(this.seconds.value/60),a=e>9?e:`0${e}`;return`${n>9?n:`0${n}`}:${a}`}restart(){this.seconds.value=this.timerTime,this.start()}stop(){this.seconds.value=0,clearInterval(this.interval)}}const E={class:"d-flex w-100"},N=s("h3",{class:"text-h5 font-weight-bold"},"Telefon raqamni tasdiqlash",-1),A={class:"my-2 d-flex align-center justify-between-start"},D={class:"text-caption font-weight-bold text-grey-darken-3"},P={class:"text-red"},U=s("p",{class:"text-grey-darken-1 w-75"}," Kiritgan raqamingizga tasdiqlovchi maxfiy kod junatildi. ",-1),K={class:"mb-4"},L={key:0},R=T({__name:"LoginSendSmsPage",setup(b){const e=V(),n=m(null),a=new I(300),o=history.state.props.phone,k={mask:"## ###-##-##"},d=m(""),v=m(!1);async function S(){v.value=!0,await e.signIn({code:+d.value,phone:o}).then(l=>{var t,i,r,c;l&&(n.value=(i=(t=l.response)==null?void 0:t.data)==null?void 0:i.message,setTimeout(()=>n.value=null,5e3),((c=(r=l.response)==null?void 0:r.data)==null?void 0:c.code)==2&&a.stop())}),v.value=!1}async function C(){await e.sendSecretCode({phone:o}),a.restart()}return(l,t)=>{const i=p("v-btn"),r=p("v-otp-input"),c=p("v-form");return f(),y(c,{onSubmit:B(S,["prevent"]),class:"text-center d-flex flex-column align-center"},{default:_(()=>[s("div",E,[g(i,{onClick:t[0]||(t[0]=u=>l.$router.go(-1)),icon:"mdi-arrow-left-thin",size:"small",variant:"tonal"})]),N,s("p",A,[s("span",D,[x(" +998 "),z(s("input",{type:"text",style:{width:"90px"},"onUpdate:modelValue":t[1]||(t[1]=u=>$(o)?o.value=u:null),disabled:""},null,512),[[h(j),void 0,k],[M,h(o)]])])]),s("div",P,w(n.value),1),U,g(r,{modelValue:d.value,"onUpdate:modelValue":t[2]||(t[2]=u=>d.value=u),length:"5"},null,8,["modelValue"]),s("main",K,[h(a).seconds.value!=0?(f(),q("div",L,w(h(a).formatted()),1)):(f(),y(i,{key:1,onClick:C,variant:"tonal",type:"button",size:"x-small"},{default:_(()=>[x("Qayta yuborish")]),_:1}))]),g(i,{type:"submit",loading:v.value,"append-icon":"mdi-login",class:"w-50",disabled:!(d.value.length>4)},{default:_(()=>[x(" Tasdiqlash ")]),_:1},8,["loading","disabled"])]),_:1})}}});export{R as default};
